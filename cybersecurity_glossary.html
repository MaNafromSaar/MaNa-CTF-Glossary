<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cybersecurity Glossary</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 20px;
      color: #333;
    }

    h1 {
      color: #2c3e50;
      text-align: center;
      margin-bottom: 20px;
    }

    .controls-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      margin-bottom: 20px;
      gap: 10px;
    }

    .search-container {
      flex: 1;
      min-width: 300px;
    }

    #search {
      padding: 10px;
      width: 100%;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }

    .view-options {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .view-btn {
      padding: 8px 15px;
      background: #f0f0f0;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
    }

    .view-btn.active {
      background: #3498db;
      color: white;
      border-color: #2980b9;
    }

    .alpha-index {
      display: flex;
      flex-wrap: wrap;
      margin: 15px 0;
      gap: 5px;
      justify-content: center;
    }

    .alpha-index a {
      display: inline-block;
      width: 30px;
      height: 30px;
      line-height: 30px;
      text-align: center;
      border: 1px solid #ddd;
      border-radius: 4px;
      text-decoration: none;
    }

    .alpha-index a:hover {
      background: #f0f0f0;
    }

    .tag-filter {
      margin: 10px 0 20px;
    }

    .tags-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .tag {
      display: inline-block;
      padding: 5px 10px;
      background: #f0f0f0;
      border-radius: 15px;
      font-size: 0.8em;
      cursor: pointer;
    }

    .tag.active {
      background: #3498db;
      color: white;
    }

    .glossary-section {
      margin-bottom: 30px;
    }

    h2 {
      color: #3498db;
      border-bottom: 2px solid #3498db;
      padding-bottom: 5px;
      margin-top: 25px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    th,
    td {
      padding: 12px 15px;
      border: 1px solid #ddd;
      text-align: left;
    }

    .term-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }

    .term-tag {
      display: inline-block;
      padding: 2px 8px;
      background: #f0f0f0;
      border-radius: 12px;
      font-size: 0.8em;
    }

    .letter-section {
      scroll-margin-top: 20px;
    }

    th {
      background-color: #f8f9fa;
      font-weight: bold;
    }

    tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    a {
      color: #2980b9;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    .hidden {
      display: none;
    }

    footer {
      margin-top: 30px;
      text-align: center;
      font-size: 0.9em;
      color: #7f8c8d;
    }

    .resources-list,
    .tools-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .resources-list li,
    .tools-list li {
      margin-bottom: 5px;
    }

    .tool-link::before {
      content: "ðŸ”§ ";
      margin-right: 5px;
    }

    .tools-list {
      border-left: 3px solid #3498db;
      padding-left: 10px;
    }

    .card-view {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .card h3 {
      margin-top: 0;
      color: #2c3e50;
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
    }

    #alpha-view .letter-heading {
      background-color: #f8f9fa;
      padding: 10px;
      margin-top: 30px;
      border-radius: 4px;
      border-left: 5px solid #3498db;
    }
  </style>
</head>

<body>
  <h1>Cybersecurity Glossary</h1>

  <div class="controls-container">
    <div class="search-container">
      <input type="text" id="search" placeholder="Search for terms, descriptions, tags...">
    </div>
    <div class="view-options">
      <button class="view-btn active" data-view="table">Table</button>
      <button class="view-btn" data-view="cards">Cards</button>
      <button class="view-btn" data-view="alpha">A-Z</button>
    </div>
  </div>

  <div class="tag-filter">
    <h3>Filter by Tags:</h3>
    <div class="tags-container" id="all-tags">
      <!-- Tags will be populated dynamically -->
    </div>
  </div>

  <div id="alpha-nav" class="alpha-index hidden">
    <!-- Alphabet index will be populated dynamically -->
  </div>

  <div id="content">
    <!-- Table View -->
    <div id="table-view" class="glossary-section">
      <table>
        <thead>
          <tr>
            <th>Term</th>
            <th>Description</th>
            <th>Tags</th>
            <th>Resources & Tools</th>
          </tr>
        </thead>
        <tbody>
          <!-- Table rows will be populated dynamically by JavaScript -->
        </tbody>
      </table>
    </div>

    <!-- Card View -->
    <div id="cards-view" class="glossary-section hidden">
      <div class="card-view">
        <!-- Cards will be populated via JavaScript -->
      </div>
    </div>

    <!-- Alphabetical View -->
    <div id="alpha-view" class="glossary-section hidden">
      <!-- Alphabet sections will be populated via JavaScript -->
    </div>
  </div>
  <!-- End of content -->

  <script>
    // To use dynamic JSON loading, serve this directory with:
    // python3 -m http.server 8080
    // Then open http://localhost:8080/cybersecurity_glossary.html in your browser.

    // Helper to escape HTML special characters
    function escapeHTML(str) {
      if (typeof str !== 'string') return str;
      return str.replace(/[&<>"']/g, function (c) {
        return ({
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;',
          "'": '&#39;'
        })[c];
      });
    }

    document.addEventListener('DOMContentLoaded', async function () {
      async function loadGlossary() {
        const response = await fetch('glossary_data.json');
        const data = await response.json();
        // Sort entries alphabetically by term before rendering
        data.entries.sort((a, b) => a.term.localeCompare(b.term, undefined, {sensitivity: 'base'}));
        return data.entries;
      }

      function createTagSpans(tags) {
        return (tags || []).map(tag => `<span class="term-tag">${escapeHTML(tag)}</span>`).join(' ');
      }

      function createFlagList(flags) {
        if (!flags || flags.length === 0) return '';
        return '<ul>' + flags.map(f => `<li>${escapeHTML(f)}</li>`).join('') + '</ul>';
      }

      function createResourceList(resources) {
        if (!resources || resources.length === 0) return '';
        return '<ul>' + resources.map(r => {
          // Escape title/description, but not the URL
          const title = r.title ? escapeHTML(r.title) : escapeHTML(r);
          const url = r.url ? r.url : r;
          // If it's a valid URL, make it a link; otherwise, just show as text
          if (url && /^https?:\/\//.test(url)) {
            return `<li><a href="${url}" target="_blank">${title}</a></li>`;
          } else {
            return `<li>${title}</li>`;
          }
        }).join('') + '</ul>';
      }

      function renderTable(entries) {
        const tbody = document.querySelector('#table-view tbody');
        tbody.innerHTML = '';
        entries.forEach(entry => {
          tbody.innerHTML += `
            <tr data-letter="${escapeHTML(entry.letter || '')}" data-tags="${(entry.tags || []).map(escapeHTML).join(',')}">
              <td>${escapeHTML(entry.term)}</td>
              <td>${escapeHTML(entry.description || '')}${entry.flags ? `<br><b>Flags:</b> ${createFlagList(entry.flags)}` : ''}</td>
              <td><div class="term-tags">${createTagSpans(entry.tags)}</div></td>
              <td>${createResourceList(entry.resources)}</td>
            </tr>
          `;
        });
      }

      function renderCards(entries) {
        let cardView = document.getElementById('cards-view');
        if (!cardView) {
          cardView = document.createElement('div');
          cardView.id = 'cards-view';
          cardView.className = 'card-view glossary-section hidden';
          document.getElementById('content').appendChild(cardView);
        }
        cardView.innerHTML = '';
        entries.forEach(entry => {
          cardView.innerHTML += `
            <div class="card" data-letter="${escapeHTML(entry.letter || '')}" data-tags="${(entry.tags || []).map(escapeHTML).join(',')}">
              <h3>${escapeHTML(entry.term)}</h3>
              <p>${escapeHTML(entry.description || '')}</p>
              ${entry.flags ? `<b>Flags:</b> ${createFlagList(entry.flags)}` : ''}
              <div class="term-tags">${createTagSpans(entry.tags)}</div>
              <div>${createResourceList(entry.resources)}</div>
            </div>
          `;
        });
      }

      // On page load, fetch and render glossary
      const entries = await loadGlossary();
      renderTable(entries);
      renderCards(entries);
      // Optionally, update tag filters and alpha index here as well
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Get all terms
      const terms = Array.from(document.querySelectorAll('#table-view tbody tr'));

      // Extract all unique tags
      const allTags = new Set();
      terms.forEach(term => {
        const tagsList = term.getAttribute('data-tags').split(',');
        tagsList.forEach(tag => allTags.add(tag));
      });

      // Populate tags filter
      const tagsContainer = document.getElementById('all-tags');
      Array.from(allTags).sort().forEach(tag => {
        const tagElement = document.createElement('span');
        tagElement.className = 'tag';
        tagElement.textContent = tag;
        tagElement.setAttribute('data-tag', tag);
        tagElement.addEventListener('click', toggleTag);
        tagsContainer.appendChild(tagElement);
      });

      // Generate alphabet index
      const letters = new Set();
      terms.forEach(term => {
        const letter = term.getAttribute('data-letter');
        if (letter) letters.add(letter);
      });

      const alphaNav = document.getElementById('alpha-nav');
      Array.from(letters).sort().forEach(letter => {
        const letterLink = document.createElement('a');
        letterLink.href = `#letter-${letter}`;
        letterLink.textContent = letter;
        alphaNav.appendChild(letterLink);
      });

      // Generate card view
      const cardsView = document.querySelector('#cards-view .card-view');
      terms.forEach(term => {
        const termName = term.querySelector('td:nth-child(1)').textContent;
        const description = term.querySelector('td:nth-child(2)').textContent;
        const tags = term.getAttribute('data-tags').split(',');
        const resources = Array.from(term.querySelectorAll('td:nth-child(4) a')).map(a => {
          return { href: a.href, text: a.textContent };
        });

        const card = document.createElement('div');
        card.className = 'card';
        card.setAttribute('data-tags', term.getAttribute('data-tags'));
        card.setAttribute('data-letter', term.getAttribute('data-letter'));

        let tagsHtml = '';
        tags.forEach(tag => {
          tagsHtml += `<span class="term-tag">${tag}</span>`;
        });

        // Separate resources and tools
        const regularResources = resources.filter(r => !r.text.startsWith('Tool:'));
        const toolResources = resources.filter(r => r.text.startsWith('Tool:'));

        let resourcesHtml = '';
        if (regularResources.length > 0) {
          resourcesHtml += '<h4>Resources:</h4><ul class="resources-list">';
          regularResources.forEach(resource => {
            resourcesHtml += `<li><a href="${resource.href}" target="_blank">${resource.text}</a></li>`;
          });
          resourcesHtml += '</ul>';
        }

        let toolsHtml = '';
        if (toolResources.length > 0) {
          toolsHtml += '<h4>Tools:</h4><ul class="tools-list">';
          toolResources.forEach(tool => {
            // Remove "Tool: " prefix for cleaner display
            const toolName = tool.text.replace('Tool: ', '');
            toolsHtml += `<li><a href="${tool.href}" target="_blank" class="tool-link">${toolName}</a></li>`;
          });
          toolsHtml += '</ul>';
        }

        card.innerHTML = `
                    <h3>${termName}</h3>
                    <p>${description}</p>
                    <div class="term-tags">${tagsHtml}</div>
                    ${resourcesHtml}
                    ${toolsHtml}
                `;

        cardsView.appendChild(card);
      });

      // Generate alphabetical view
      const alphaView = document.getElementById('alpha-view');
      const letterGroups = {};

      terms.forEach(term => {
        const letter = term.getAttribute('data-letter');
        if (!letterGroups[letter]) {
          letterGroups[letter] = [];
        }
        letterGroups[letter].push(term);
      });

      Object.keys(letterGroups).sort().forEach(letter => {
        const letterSection = document.createElement('div');
        letterSection.className = 'letter-section';
        letterSection.id = `letter-${letter}`;

        letterSection.innerHTML = `<h2 class="letter-heading">${letter}</h2>`;

        const termsList = document.createElement('div');
        termsList.className = 'card-view';

        letterGroups[letter].forEach(term => {
          const termName = term.querySelector('td:nth-child(1)').textContent;
          const description = term.querySelector('td:nth-child(2)').textContent;
          const tags = term.getAttribute('data-tags').split(',');
          const resources = Array.from(term.querySelectorAll('td:nth-child(4) a')).map(a => {
            return { href: a.href, text: a.textContent };
          });

          const card = document.createElement('div');
          card.className = 'card';
          card.setAttribute('data-tags', term.getAttribute('data-tags'));

          let tagsHtml = '';
          tags.forEach(tag => {
            tagsHtml += `<span class="term-tag">${tag}</span>`;
          });          // Separate resources and tools
          const regularResources = resources.filter(r => !r.text.startsWith('Tool:'));
          const toolResources = resources.filter(r => r.text.startsWith('Tool:'));

          let resourcesHtml = '';
          if (regularResources.length > 0) {
            resourcesHtml += '<h4>Resources:</h4><ul class="resources-list">';
            regularResources.forEach(resource => {
              resourcesHtml += `<li><a href="${resource.href}" target="_blank">${resource.text}</a></li>`;
            });
            resourcesHtml += '</ul>';
          }

          let toolsHtml = '';
          if (toolResources.length > 0) {
            toolsHtml += '<h4>Tools:</h4><ul class="tools-list">';
            toolResources.forEach(tool => {
              // Remove "Tool: " prefix for cleaner display
              const toolName = tool.text.replace('Tool: ', '');
              toolsHtml += `<li><a href="${tool.href}" target="_blank" class="tool-link">${toolName}</a></li>`;
            });
            toolsHtml += '</ul>';
          }

          card.innerHTML = `
                        <h3>${termName}</h3>
                        <p>${description}</p>
                        <div class="term-tags">${tagsHtml}</div>
                        ${resourcesHtml}
                        ${toolsHtml}
                    `;

          termsList.appendChild(card);
        });

        letterSection.appendChild(termsList);
        alphaView.appendChild(letterSection);
      });

      // View switching
      const viewButtons = document.querySelectorAll('.view-btn');
      const views = {
        'table': document.getElementById('table-view'),
        'cards': document.getElementById('cards-view'),
        'alpha': document.getElementById('alpha-view')
      };

      viewButtons.forEach(btn => {
        btn.addEventListener('click', function () {
          const viewType = this.getAttribute('data-view');

          // Update button states
          viewButtons.forEach(b => b.classList.remove('active'));
          this.classList.add('active');

          // Show selected view, hide others
          Object.keys(views).forEach(key => {
            views[key].classList.add('hidden');
          });
          views[viewType].classList.remove('hidden');

          // Show/hide alphabet navigation
          if (viewType === 'alpha') {
            document.getElementById('alpha-nav').classList.remove('hidden');
          } else {
            document.getElementById('alpha-nav').classList.add('hidden');
          }
        });
      });

      // Search functionality
      document.getElementById('search').addEventListener('keyup', function () {
        const searchValue = this.value.toLowerCase();

        // Table view filtering
        const tableRows = document.querySelectorAll('#table-view tbody tr');
        tableRows.forEach(row => {
          const text = row.textContent.toLowerCase();
          if (text.includes(searchValue)) {
            row.classList.remove('hidden');
          } else {
            row.classList.add('hidden');
          }
        });

        // Card view filtering
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
          const text = card.textContent.toLowerCase();
          if (text.includes(searchValue)) {
            card.classList.remove('hidden');
          } else {
            card.classList.add('hidden');
          }
        });

        // Alpha view letter sections
        if (document.querySelector('#alpha-view:not(.hidden)')) {
          document.querySelectorAll('.letter-section').forEach(section => {
            const visibleCards = section.querySelectorAll('.card:not(.hidden)').length;
            if (visibleCards === 0) {
              section.classList.add('hidden');
            } else {
              section.classList.remove('hidden');
            }
          });
        }
      });

      // Tag filtering
      const activeTags = new Set();

      function toggleTag() {
        const tag = this.getAttribute('data-tag');

        if (this.classList.contains('active')) {
          this.classList.remove('active');
          activeTags.delete(tag);
        } else {
          this.classList.add('active');
          activeTags.add(tag);
        }

        filterByTags();
      }

      function filterByTags() {
        // If no tags selected, show all
        if (activeTags.size === 0) {
          document.querySelectorAll('#table-view tbody tr, .card').forEach(element => {
            element.classList.remove('hidden');
          });

          // Show all letter sections in alpha view
          document.querySelectorAll('.letter-section').forEach(section => {
            section.classList.remove('hidden');
          });

          return;
        }

        // Filter table rows and cards
        document.querySelectorAll('#table-view tbody tr, .card').forEach(element => {
          const elementTags = element.getAttribute('data-tags').split(',');
          const hasAllTags = Array.from(activeTags).every(tag => elementTags.includes(tag));

          if (hasAllTags) {
            element.classList.remove('hidden');
          } else {
            element.classList.add('hidden');
          }
        });

        // Hide empty letter sections in alpha view
        document.querySelectorAll('.letter-section').forEach(section => {
          const visibleCards = section.querySelectorAll('.card:not(.hidden)').length;
          if (visibleCards === 0) {
            section.classList.add('hidden');
          } else {
            section.classList.remove('hidden');
          }
        });
      }
    });
  </script>
</body>

</html>
